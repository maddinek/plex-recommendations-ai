# Plex AI Recommendations

This script generates personalized movie and TV show recommendations based on your Plex watch history, creates collections in Plex, and adds missing titles to Ombi for requesting. It also integrates with Trakt to add missing titles to your Trakt collection.

## Features

- Retrieves your watch history from Plex
- Generates personalized recommendations using GPT-4o mini API
- Creates and updates collections in Plex based on recommendations
- Adds missing titles to Ombi for requesting
- Adds missing titles to Trakt collections
- Supports various themed collections (e.g., Seasonal, Holiday, Romantic Comedy)
- Saves recommendations to CSV files

## Prerequisites

- Python 3.9+
- Plex Media Server
- Ombi (optional, for requesting missing titles)
- Trakt account (optional, for adding missing titles to your Trakt collection)
- GPT-4o mini API access

## Installation

1. Clone this repository:
   ```sh
   git clone https://github.com/yourusername/plex-ai-recommendations.git
   cd plex-ai-recommendations
   ```

2. Install required packages:
   ```sh
   pip install -r requirements.txt
   ```

3. Create a `config` directory and add a `plex_recommendations.ini` file with the following content:
   ```ini
   [PLEX]
   PLEX_URL = http://your-plex-server:32400
   PLEX_TOKEN = your-plex-token

   [GPT]
   GPT4O_API_KEY = your-gpt4o-api-key

   [OMBI]
   OMBI_URL = http://your-ombi-server:3579
   OMBI_API_KEY = your-ombi-api-key

   [TRAKT]
   CLIENT_ID = your-trakt-client-id
   CLIENT_SECRET = your-trakt-client-secret
   access_token = 
   refresh_token = 
   token_expiry = 
   
   [RECOMMENDATIONS]
   NUMBER_OF_RECOMMENDATIONS = 10
   ```

   Replace the placeholder values with your actual Plex, GPT-4o, Ombi (if using), and Trakt credentials.

4. Create an `output` directory to store generated recommendation files.

## Usage

Run the script:
```sh
python plex-recommendations.py
```

The script will:

1. Retrieve your watch history from Plex
2. Generate recommendations for movies and TV shows
3. Create or update collections in Plex
4. Add missing titles to Ombi (if configured)
5. Add missing titles to Trakt collections (if configured)
6. Save recommendations to CSV files in the output directory

## Configuration

### Number of Recommendations

The number of recommendations generated by the script can be adjusted using the `NUMBER_OF_RECOMMENDATIONS` variable in the `[RECOMMENDATIONS]` section of the `plex_recommendations.ini` file. For example:

```ini
[RECOMMENDATIONS]
NUMBER_OF_RECOMMENDATIONS = 10
```

### Adding Further Collections

To add more themed collections, you can modify the `additional_collections` list in the `main()` function. For each collection, provide a name and a description prompt to generate recommendations. For example:

```python
additional_collections = [
    ("Seasonal", "Recommend 10 movies suitable for the current season."),
    ("Holiday", "Recommend 10 movies suitable for the upcoming holiday."),
    ("Romantic Comedy", "Recommend 10 top romantic comedy movies."),
    # Add more collections here
]
```

The script will generate recommendations based on the prompt and create a new collection in Plex.

## Running with Docker

You can also run the application using Docker. Here are the steps:

1. Build the Docker image:
   ```sh
   podman-compose build
   ```

2. Start the container:
   ```sh
   podman-compose up
   ```

This will create and run the container, mounting the necessary `config` and `output` directories.

## Contributing

Contributions are welcome! Please feel free to submit a Pull Request.

## License

This project is licensed under the MIT License - see the LICENSE file for details.

